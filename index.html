<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ai Life | Pure Experience</title>
    <style>
        :root {
            --primary: #1d1d1f;
            --accent-pink: #FF2D55;
            --accent-blue: #007AFF;
            --expo: cubic-bezier(0.65, 0, 0.35, 1);
            --apple-ease: cubic-bezier(0.25, 0.1, 0.25, 1);
            --glass-border: rgba(255, 255, 255, 0.5);
            --glass-bg: rgba(255, 255, 255, 0.3);
            /* 极光彩色流体序列 - 优化渐变色彩过渡 */
            --aurora-gradient: linear-gradient(120deg, #4facfe 0%, #00f2fe 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
            /* 新增响应式断点变量 */
            --breakpoint-mobile: 768px;
        }

        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
            /* 优化动画性能 */
            will-change: transform, opacity, filter;
        }
        
        body {
            background: #ffffff; 
            color: var(--primary);
            font-family: "SF Pro Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            overflow: hidden; 
            height: 100vh; 
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            /* 防止页面抖动 */
            overscroll-behavior: none;
        }

        /* --- 1. 封面 --- */
        #cover-layer {
            position: fixed; 
            inset: 0; 
            z-index: 2000;
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center;
            background: #fff; 
            transition: all 1.5s var(--expo);
            /* 优化点击区域 */
            cursor: pointer;
        }

        .ai-life-title {
            font-size: clamp(40px, 10vw, 100px); 
            font-weight: 800; 
            letter-spacing: -0.04em; 
            margin-bottom: clamp(40px, 8vw, 60px);
            background: linear-gradient(to right, #4158D0, #C850C0, #FFCC70, #4158D0);
            background-size: 200% auto; 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
            animation: shine 5s linear infinite;
        }

        @keyframes shine { 
            to { background-position: 200% center; } 
        }

        .start-btn-wrap { 
            position: relative; 
            width: 140px; 
            height: 140px; 
            cursor: pointer; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            /* 防止按钮点击穿透 */
            pointer-events: auto;
        }
        
        /* 改进的呼吸光晕按钮 - 优化性能 */
        .btn-halo {
            position: absolute; 
            inset: 10px; 
            border-radius: 50%;
            background: var(--aurora-gradient); 
            background-size: 200% auto;
            opacity: 0.15; 
            filter: blur(20px); 
            animation: shine 4s linear infinite, btnPulse 3s ease-in-out infinite;
            transform: scale(0.9) translateZ(0); 
            transition: all 0.8s var(--apple-ease);
            /* 硬件加速 */
            will-change: transform, opacity;
        }
        
        @keyframes btnPulse { 
            0%, 100% { transform: scale(0.9) translateZ(0); opacity: 0.15; } 
            50% { transform: scale(1.1) translateZ(0); opacity: 0.25; } 
        }
        
        .start-btn-wrap:hover .btn-halo { 
            transform: scale(1.25) translateZ(0); 
            opacity: 0.4; 
        }

        .glass-btn { 
            width: 80px; 
            height: 80px; 
            background: rgba(255,255,255,0.9); 
            backdrop-filter: blur(20px); 
            -webkit-backdrop-filter: blur(20px);
            border-radius: 50%; 
            border: 1px solid #fff;
            display: flex; 
            justify-content: center; 
            align-items: center; 
            z-index: 10; 
            transition: all 0.6s var(--apple-ease); 
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            /* 优化点击反馈 */
            touch-action: manipulation;
        }

        /* --- 2. 场景覆盖层 --- */
        #scene-overlay {
            position: fixed; 
            inset: 0; 
            z-index: 1500;
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center;
            pointer-events: none; 
            opacity: 0; 
            transition: all 1.2s var(--expo);
            padding: 0 20px; /* 移动端内边距 */
        }

        #blur-shield {
            position: fixed; 
            inset: 0; 
            z-index: 1400;
            backdrop-filter: blur(0px); 
            -webkit-backdrop-filter: blur(0px);
            background: rgba(255,255,255,0);
            pointer-events: none; 
            transition: all 1s var(--expo);
            /* 优化模糊性能 */
            will-change: backdrop-filter, background;
        }

        .scene-text-en { 
            font-size: clamp(40px, 10vw, 8vw); 
            font-weight: 800; 
            opacity: 0.1; 
            filter: blur(10px); 
            transform: scale(1.3) translateZ(0); 
            transition: all 1.2s var(--expo); 
        }
        
        .scene-text-cn { 
            font-size: clamp(24px, 5vw, 42px); 
            font-weight: 600; 
            margin-top: -30px; 
            transform: translateY(30px) translateZ(0); 
            opacity: 0; 
            transition: all 1s var(--expo) 0.2s;
            text-align: center;
        }
        
        .scene-desc { 
            font-size: clamp(14px, 2vw, 18px); 
            color: #86868b; 
            margin-top: 20px; 
            max-width: 90%;
            text-align: center; 
            line-height: 1.8; 
            transform: translateY(20px) translateZ(0); 
            opacity: 0; 
            transition: all 1s var(--expo) 0.4s;
        }

        .show-overlay #scene-overlay { opacity: 1; }
        .show-overlay #blur-shield { 
            backdrop-filter: blur(30px); 
            -webkit-backdrop-filter: blur(30px);
            background: rgba(255,255,255,0.4); 
        }
        .show-overlay .scene-text-en { 
            transform: scale(1) translateZ(0); 
            filter: blur(0); 
            opacity: 0.2; 
        }
        .show-overlay .scene-text-cn { 
            transform: translateY(0) translateZ(0); 
            opacity: 1; 
        }
        .show-overlay .scene-desc { 
            transform: translateY(0) translateZ(0); 
            opacity: 1; 
        }

        /* --- 3. 终极名言：极光流体样式 - 核心修复 --- */
        .final-quote-mode { 
            width: 100vw;
            z-index: 1600 !important; /* 提升层级确保显示 */
        }
        .final-quote-mode .scene-text-cn {
            background: var(--aurora-gradient);
            background-size: 300% auto; 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
            animation: auroraFlow 6s linear infinite;
            font-size: clamp(22px, 4.5vw, 54px); 
            font-weight: 800; 
            letter-spacing: 0.8em; 
            text-indent: 0.8em; 
            opacity: 0; 
            transform: scale(1.2) translateZ(0);
            transition: all 3.5s var(--expo) !important;
            filter: blur(25px);
            white-space: pre-wrap; /* 移动端换行优化 */
            margin-top: 0;
            line-height: 1.5;
            /* 修复移动端字间距 */
            letter-spacing: clamp(0.2em, 0.8em, 0.8em);
            text-indent: clamp(0.2em, 0.8em, 0.8em);
        }

        @keyframes auroraFlow {
            0% { background-position: 0% 50%; }
            100% { background-position: 300% 50%; }
        }

        /* 修复：将final-active加到body上，确保样式优先级 */
        body.show-overlay.final-active #scene-overlay.final-quote-mode .scene-text-cn {
            opacity: 1 !important; 
            letter-spacing: 0.02em !important; 
            text-indent: 0.02em !important;
            transform: scale(1) translateZ(0) !important; 
            filter: blur(0) !important;
        }

        .final-quote-mode .scene-text-en, 
        .final-quote-mode .scene-desc { display: none; }

        .quote-blur-out { 
            filter: blur(100px) !important; 
            opacity: 0 !important; 
            transform: scale(0.8) translateZ(0) !important; 
            transition: all 2.5s var(--expo) !important; 
        }

        /* --- 4. 3D 舞台 --- */
        .stage { 
            position: relative; 
            width: 100vw; 
            height: 100vh; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            perspective: 2500px; 
            transition: all 1.5s var(--expo);
            /* 优化3D性能 */
            perspective-origin: center center;
        }
        
        #rig { 
            width: 1000px; 
            aspect-ratio: 1000 / 620; 
            transform-style: preserve-3d; 
            transform: rotateX(15deg) rotateY(-10deg) scale(0.7) translateZ(0); 
            opacity: 0; 
            transition: all 2s var(--expo);
            /* 硬件加速 */
            backface-visibility: hidden;
            will-change: transform, opacity;
        }
        
        #rig.focus-translate { 
            transform: rotateX(5deg) rotateY(15deg) translateX(150px) scale(1.15) translateZ(0); 
        }
        
        #rig.focus-learning { 
            transform: rotateX(5deg) rotateY(-15deg) translateX(-180px) scale(1.15) translateZ(0); 
        }

        /* 舞台撤走动画 - 优化过渡 */
        #rig.stage-exit { 
            transform: rotateX(-20deg) translateY(800px) scale(0.4) translateZ(0) !important; 
            opacity: 0 !important; 
            filter: blur(40px);
            transition: all 1.5s var(--expo) !important;
        }

        .app-shell { 
            width: 100%; 
            height: 100%; 
            background: rgba(255,255,255,0.92); 
            border-radius: 44px; 
            box-shadow: 0 60px 120px rgba(0,0,0,0.08); 
            display: flex; 
            flex-direction: column; 
            overflow: hidden; 
            border: 1px solid #fff;
        }
        
        .content-main { 
            flex: 1; 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            padding: 50px; 
            gap: 30px;
            /* 移动端适配 */
            @media (max-width: var(--breakpoint-mobile)) {
                grid-template-columns: 1fr;
                padding: 20px;
                gap: 20px;
            }
        }
        
        .panel { 
            background: #fff; 
            border-radius: 36px; 
            padding: 40px; 
            transition: opacity 0.8s var(--expo);
            /* 移动端适配 */
            @media (max-width: var(--breakpoint-mobile)) {
                padding: 20px;
                border-radius: 24px;
            }
        }
        
        .highlight { 
            color: var(--accent-blue); 
            font-weight: 600; 
            background: rgba(0,122,255,0.08); 
            padding: 2px 8px; 
            border-radius: 8px; 
        }

        #flash { 
            position: fixed; 
            inset: 0; 
            background: #fff; 
            z-index: 3000; 
            opacity: 0; 
            pointer-events: none; 
            transition: opacity 1.2s ease-in-out;
        }

        /* 加载状态提示 */
        .loading-indicator {
            position: absolute;
            bottom: 40px;
            font-size: 12px;
            color: #86868b;
            letter-spacing: 0.2em;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        #cover-layer:hover .loading-indicator {
            opacity: 1;
        }

        /* 无障碍优化 - 焦点样式 */
        .glass-btn:focus-visible,
        .start-btn-wrap:focus-visible {
            outline: 2px solid var(--accent-blue);
            outline-offset: 4px;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <div id="flash"></div>
    <div id="blur-shield"></div>

    <div id="scene-overlay">
        <div class="scene-text-en" id="big-en"></div>
        <div class="scene-text-cn" id="big-cn"></div>
        <div class="scene-desc" id="big-desc"></div>
    </div>

    <div id="cover-layer" tabindex="0" aria-label="点击开始AI Life演示">
        <!-- 修改标题为 Ai Life Tool -->
        <h1 class="ai-life-title">Ai Life Tool</h1>
        <div class="start-btn-wrap" onclick="startCinematicJourney()">
            <div class="btn-halo"></div>
            <div class="glass-btn">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="#1d1d1f" aria-hidden="true">
                    <path d="M8 5v14l11-7z"/>
                </svg>
            </div>
        </div>
        <p style="margin-top: 40px; font-size: 13px; letter-spacing: 0.4em; color: #86868b; font-weight: 500;">START SESSION</p>
        <p class="loading-indicator">CLICK TO START</p>
    </div>

    <div class="stage" id="main-stage">
        <div id="rig">
            <div class="app-shell">
                <div style="padding: 24px 50px; border-bottom: 1px solid rgba(0,0,0,0.03); font-size: 12px; font-weight: 700; color:#d2d2d7; letter-spacing: 2px;">
                    NEURAL ENGINE V4.0 / <span id="status-text" style="color:var(--accent-pink)">ACTIVE</span>
                </div>
                <div class="content-main">
                    <div class="panel" id="trans-panel">
                        <div style="font-size: 11px; font-weight: 700; color: var(--accent-pink); margin-bottom: 20px; letter-spacing: 1px;">INSTANT TRANSLATION</div>
                        <div id="src-text" style="font-size: 26px; line-height: 1.5; margin-bottom: 30px;"></div>
                        <div id="dest-text" style="font-size: 26px; color: var(--accent-pink); font-weight: 600;"></div>
                    </div>
                    <div class="panel" id="learn-panel" style="opacity:0.2;">
                        <div style="font-size: 11px; font-weight: 700; color: var(--accent-blue); margin-bottom: 20px; letter-spacing: 1px;">DEEP LEARNING</div>
                        <div id="analysis-list" style="font-size: 15px; line-height: 2.2;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 全局状态管理 - 优化可维护性
        const appState = {
            isAnimating: false,
            animationSpeed: 1, // 动画速度系数，可用于全局调整
            elements: {
                coverLayer: null,
                flash: null,
                rig: null,
                sceneOverlay: null,
                blurShield: null,
                bigEn: null,
                bigCn: null,
                bigDesc: null,
                transPanel: null,
                learnPanel: null,
                srcText: null,
                destText: null,
                analysisList: null
            },
            content: {
                src: "The most profound technologies are those that disappear.",
                dest: "最深奥的技术，是那些消失在生活中的技术。",
                nodes: [
                    { w: "profound", d: "adj. 深奥的 /prəˈfaʊnd/" },
                    { w: "disappear", d: "v. 消失 /ˌdɪsəˈpɪr/" }
                ]
            }
        };

        // 初始化DOM元素引用 - 避免重复查询
        function initElements() {
            appState.elements.coverLayer = document.getElementById('cover-layer');
            appState.elements.flash = document.getElementById('flash');
            appState.elements.rig = document.getElementById('rig');
            appState.elements.sceneOverlay = document.getElementById('scene-overlay');
            appState.elements.blurShield = document.getElementById('blur-shield');
            appState.elements.bigEn = document.getElementById('big-en');
            appState.elements.bigCn = document.getElementById('big-cn');
            appState.elements.bigDesc = document.getElementById('big-desc');
            appState.elements.transPanel = document.getElementById('trans-panel');
            appState.elements.learnPanel = document.getElementById('learn-panel');
            appState.elements.srcText = document.getElementById('src-text');
            appState.elements.destText = document.getElementById('dest-text');
            appState.elements.analysisList = document.getElementById('analysis-list');
        }

        // 工具函数 - 抽离通用逻辑
        const utils = {
            wait: (ms) => new Promise(res => setTimeout(res, ms * appState.animationSpeed)),
            setText: (el, text) => { if (el) el.textContent = text; },
            setHtml: (el, html) => { if (el) el.innerHTML = html; },
            addClass: (el, className) => { if (el) el.classList.add(className); },
            removeClass: (el, className) => { if (el) el.classList.remove(className); },
            replaceClass: (el, oldClass, newClass) => { if (el) el.classList.replace(oldClass, newClass); },
            setStyle: (el, prop, value) => { if (el) el.style[prop] = value; }
        };

        /**
         * 场景触发函数 - 修复名言显示逻辑
         * @param {string} en - 英文文本
         * @param {string} cn - 中文文本
         * @param {string} desc - 描述文本
         * @param {string} color - 文本颜色
         * @param {number} duration - 展示时长
         * @param {boolean} isFinal - 是否为最终名言场景
         */
        async function triggerScene(en, cn, desc, color, duration = 3000, isFinal = false) {
            const { sceneOverlay, rig, bigEn, bigCn, bigDesc } = appState.elements;
            
            // 重置所有相关类名
            utils.removeClass(document.body, 'show-overlay', 'final-active');
            utils.removeClass(sceneOverlay, 'quote-blur-out', 'final-quote-mode', 'final-active');
            
            // 设置文本内容
            utils.setText(bigEn, en);
            utils.setText(bigCn, cn);
            utils.setText(bigDesc, desc);
            
            if (isFinal) {
                // 1. 让翻译框撤走（增加等待确保动画执行）
                utils.addClass(rig, 'stage-exit');
                await utils.wait(500); // 等待舞台撤走动画开始
                
                // 2. 准备名言场景（关键修复：先加模式类，再加显示类）
                utils.addClass(sceneOverlay, 'final-quote-mode');
                utils.addClass(document.body, 'show-overlay');
                await utils.wait(100);
                
                // 3. 触发汇聚动画（关键修复：final-active加到body上）
                utils.addClass(document.body, 'final-active');
            } else {
                // 设置文本颜色
                utils.setStyle(bigEn, 'color', color);
                utils.setStyle(bigCn, 'color', color);
                utils.addClass(document.body, 'show-overlay');
            }

            await utils.wait(duration);
            
            if (isFinal) {
                // 名言淡出
                utils.addClass(sceneOverlay, 'quote-blur-out');
                await utils.wait(1500); // 等待淡出动画完成
            }
            
            // 重置类名
            utils.removeClass(document.body, 'show-overlay', 'final-active');
            utils.removeClass(sceneOverlay, 'final-quote-mode');
            await utils.wait(300);
        }

        /**
         * 打字机效果 - 优化性能，避免频繁DOM操作
         * @param {HTMLElement} el - 目标元素
         * @param {string} text - 要显示的文本
         * @param {number} speed - 打字速度
         */
        async function typeText(el, text, speed) {
            if (!el) return;
            
            el.textContent = '';
            const textArr = text.split('');
            
            // 使用requestAnimationFrame优化动画流畅度
            for (let i = 0; i < textArr.length; i++) {
                await new Promise(res => {
                    requestAnimationFrame(() => {
                        el.textContent = textArr.slice(0, i + 1).join('');
                        setTimeout(res, speed * appState.animationSpeed);
                    });
                });
            }
        }

        /**
         * 深度解析动画 - 优化DOM操作
         */
        async function runAnalysis() {
            const { srcText, analysisList } = appState.elements;
            let txt = appState.content.src;
            
            // 清空解析列表
            utils.setHtml(analysisList, '');
            
            for (const node of appState.content.nodes) {
                // 高亮词汇
                txt = txt.replace(node.w, `<span class="highlight">${node.w}</span>`);
                utils.setHtml(srcText, txt);
                
                // 创建解析项
                const div = document.createElement('div');
                div.innerHTML = `<strong>${node.w}</strong> <span style="color:#86868b; margin-left:10px;">${node.d}</span>`;
                div.style.cssText = "opacity:0; transform:translateX(20px); transition:all 0.6s var(--expo);";
                analysisList.appendChild(div);
                
                await utils.wait(400);
                
                // 触发动画
                div.style.opacity = "1";
                div.style.transform = "translateX(0)";
                
                await utils.wait(1000);
            }
        }

        /**
         * 重置所有状态 - 优化重置逻辑（核心修复：完全重置舞台的transform）
         */
        function resetAllStates() {
            const { rig, transPanel, learnPanel, srcText, destText, analysisList, sceneOverlay } = appState.elements;
            
            // 重置舞台 - 核心修复：不仅移除类名，还重置transform到初始状态
            utils.setStyle(rig, 'opacity', '0');
            utils.removeClass(rig, 'focus-translate', 'focus-learning', 'stage-exit');
            // 手动重置transform到初始值，确保第二次循环舞台位置正确
            utils.setStyle(rig, 'transform', 'rotateX(15deg) rotateY(-10deg) scale(0.7) translateZ(0)');
            
            // 重置面板
            utils.setStyle(transPanel, 'opacity', '1');
            utils.setStyle(learnPanel, 'opacity', '0.2');
            utils.setText(srcText, '');
            utils.setText(destText, '');
            utils.setHtml(analysisList, '');
            
            // 重置名言场景
            utils.removeClass(document.body, 'show-overlay', 'final-active');
            utils.removeClass(sceneOverlay, 'quote-blur-out', 'final-quote-mode', 'final-active');
        }

        /**
         * 主动画流程 - 优化逻辑结构
         */
        async function startCinematicJourney() {
            if (appState.isAnimating) return;
            appState.isAnimating = true;
            
            const { coverLayer, flash, rig, transPanel, learnPanel } = appState.elements;

            try {
                // 1. 封面淡出
                utils.setStyle(coverLayer, 'opacity', '0');
                utils.setStyle(coverLayer, 'transform', 'scale(1.1)');
                await utils.wait(1000);
                utils.setStyle(rig, 'opacity', '1');

                // 2. 快速翻译模式
                await triggerScene("QUICK MODE", "快速翻译模式", "简洁地呈现含义，跨越语言鸿沟。", "#FF2D55");
                utils.addClass(rig, 'focus-translate');
                await typeText(appState.elements.srcText, appState.content.src, 40);
                await utils.wait(500);
                await typeText(appState.elements.destText, appState.content.dest, 50);
                await utils.wait(2000);

                // 3. 深度学习模式
                await triggerScene("DEEP LEARNING", "深度学习模式", "解析核心词汇，多维度深度解析。", "#007AFF");
                utils.replaceClass(rig, 'focus-translate', 'focus-learning');
                utils.setStyle(transPanel, 'opacity', '0.4');
                utils.setStyle(learnPanel, 'opacity', '1');
                await runAnalysis();
                await utils.wait(2000);

                // 4. 终极名言场景（延长展示时间确保看清楚）
                await triggerScene("", "AI工具不在于它是怎样的形式，而在于是否能轻易使用", "", "", 8000, true);

                // 5. 闪白效果
                utils.setStyle(flash, 'opacity', '1');
                await utils.wait(1200);

                // 6. 重置所有状态
                resetAllStates();
                utils.setStyle(flash, 'opacity', '0');
                utils.setStyle(coverLayer, 'transform', 'scale(1)');
                utils.setStyle(coverLayer, 'opacity', '1');
                await utils.wait(1500);
            } catch (error) {
                console.error('动画执行出错:', error);
                // 出错后重置状态
                resetAllStates();
                utils.setStyle(coverLayer, 'opacity', '1');
                utils.setStyle(coverLayer, 'transform', 'scale(1)');
            } finally {
                appState.isAnimating = false;
            }
        }

        // 初始化应用
        function initApp() {
            initElements();
            
            // 无障碍支持 - 键盘回车触发
            appState.elements.coverLayer.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !appState.isAnimating) {
                    startCinematicJourney();
                }
            });

            // 防止移动端触摸穿透
            document.addEventListener('touchstart', (e) => {
                if (appState.isAnimating) {
                    e.preventDefault();
                }
            }, { passive: false });
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
